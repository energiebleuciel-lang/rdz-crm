<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test LP - Panneaux Solaires | EnerSolar</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Arial, sans-serif; background: linear-gradient(135deg, #1e3a5f 0%, #0d1b2a 100%); min-height: 100vh; color: white; }
    .container { max-width: 1000px; margin: 0 auto; padding: 60px 20px; text-align: center; }
    h1 { font-size: 2.5rem; margin-bottom: 20px; }
    .subtitle { font-size: 1.2rem; color: #94a3b8; margin-bottom: 40px; }
    .benefits { display: flex; gap: 30px; justify-content: center; margin: 40px 0; flex-wrap: wrap; }
    .benefit { background: rgba(255,255,255,0.1); padding: 25px; border-radius: 12px; flex: 1; min-width: 250px; }
    .benefit h3 { color: #fbbf24; margin-bottom: 10px; }
    .cta-btn { display: inline-block; background: #f59e0b; color: #1e3a5f; padding: 18px 40px; font-size: 1.2rem; font-weight: bold; border: none; border-radius: 8px; cursor: pointer; text-decoration: none; transition: all 0.3s; margin: 10px; }
    .cta-btn:hover { background: #fbbf24; transform: scale(1.05); }
    .debug { position: fixed; bottom: 20px; right: 20px; background: rgba(0,0,0,0.8); padding: 15px; border-radius: 8px; font-size: 12px; max-width: 300px; }
    .debug h4 { color: #fbbf24; margin-bottom: 10px; }
    .debug code { color: #4ade80; }
  </style>

  <!-- ===== SCRIPT DE TRACKING LP ===== -->
  <script>
  (function() {
    var CONFIG = {
      API_URL: "https://solar-crm-14.preview.emergentagent.com",
      LP_CODE: "LP-TEST-001",
      FORM_CODE: "FORM-TEST-001",
      FORM_URL: "test_form.html",
      LIAISON_CODE: "LP-TEST-001_FORM-TEST-001",
      PRODUCT_TYPE: "PV",
      MODE: "redirect"
    };

    var urlParams = new URLSearchParams(window.location.search);
    var UTM = {
      source: urlParams.get("utm_source") || "",
      medium: urlParams.get("utm_medium") || "",
      campaign: urlParams.get("utm_campaign") || ""
    };

    function trackLPView() {
      console.log("[LP] Tracking visit...");
      fetch(CONFIG.API_URL + "/api/track/lp-visit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ lp_code: CONFIG.LP_CODE, referrer: document.referrer })
      })
      .then(r => r.json())
      .then(data => { 
        console.log("[LP] Visit tracked:", data);
        document.getElementById('debug-status').textContent = 'Visite track√©e ‚úì';
      })
      .catch(e => { 
        console.error("[LP] Error:", e);
        document.getElementById('debug-status').textContent = 'Erreur: ' + e;
      });
    }

    window.trackCTAClick = function(ctaId, ctaText) {
      console.log("[LP] CTA clicked:", ctaId);
      document.getElementById('debug-status').textContent = 'CTA cliqu√©...';
      
      fetch(CONFIG.API_URL + "/api/track/cta-click", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ lp_code: CONFIG.LP_CODE, form_code: CONFIG.FORM_CODE })
      })
      .then(r => r.json())
      .then(data => { 
        console.log("[LP] CTA tracked:", data);
        
        var formUrl = CONFIG.FORM_URL;
        var sep = formUrl.indexOf("?") === -1 ? "?" : "&";
        formUrl += sep + "lp=" + CONFIG.LP_CODE + "&liaison=" + CONFIG.LIAISON_CODE;
        if (UTM.source) formUrl += "&utm_source=" + encodeURIComponent(UTM.source);
        if (UTM.medium) formUrl += "&utm_medium=" + encodeURIComponent(UTM.medium);
        if (UTM.campaign) formUrl += "&utm_campaign=" + encodeURIComponent(UTM.campaign);
        
        console.log("[LP] Redirecting to:", formUrl);
        window.location.href = formUrl;
      })
      .catch(e => { 
        console.error("[LP] CTA Error:", e);
        document.getElementById('debug-status').textContent = 'Erreur CTA: ' + e;
      });
    };

    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", trackLPView);
    } else {
      trackLPView();
    }
    
    console.log("[LP] Script initialized - Code:", CONFIG.LP_CODE);
  })();
  </script>
</head>
<body>
  <div class="container">
    <h1>‚ö° √âconomisez jusqu'√† 70% sur votre facture d'√©lectricit√©</h1>
    <p class="subtitle">Passez √† l'√©nergie solaire avec nos panneaux photovolta√Øques derni√®re g√©n√©ration</p>
    
    <div class="benefits">
      <div class="benefit">
        <h3>üè† Installation gratuite</h3>
        <p>Devis et √©tude de faisabilit√© offerts</p>
      </div>
      <div class="benefit">
        <h3>üí∞ Aides de l'√âtat</h3>
        <p>Jusqu'√† 4000‚Ç¨ de prime √©nergie</p>
      </div>
      <div class="benefit">
        <h3>üîß Garantie 25 ans</h3>
        <p>Installation et maintenance incluses</p>
      </div>
    </div>
    
    <button class="cta-btn" onclick="trackCTAClick('hero-btn', 'Demander mon devis')">
      ‚ûú Demander mon devis gratuit
    </button>
    
    <button class="cta-btn" onclick="trackCTAClick('secondary-btn', 'Estimation rapide')" style="background: transparent; border: 2px solid #f59e0b; color: #f59e0b;">
      Estimation rapide ‚Üí
    </button>
  </div>
  
  <div class="debug">
    <h4>üîß Debug Panel</h4>
    <p><strong>LP:</strong> <code>LP-TEST-001</code></p>
    <p><strong>Form:</strong> <code>FORM-TEST-001</code></p>
    <p><strong>API:</strong> <code>Emergent Preview</code></p>
    <p><strong>Status:</strong> <span id="debug-status">Initialisation...</span></p>
  </div>
</body>
</html>
